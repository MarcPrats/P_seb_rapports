\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[french]{babel}
\usepackage{enumitem}
%\frenchbsetup{StandardLists=true}
\usepackage{caption}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{subfigure}
\usepackage{appendix}
\usepackage{listings}
\usepackage{multicol}
\usepackage{moreverb}
\usepackage{epsfig}
\usepackage{textcomp}
\usepackage{hyperref}
\usepackage{xcolor}
      %%%%%%%%%%%%%%%%  inclure la source %%%%%%%%%%%%%%%%%%%%
  \newcommand*\styleC{\fontsize{9}{10pt}\usefont{T1}{cmtt}{m}{n}\selectfont }
  \newcommand*\styleD{\fontsize{9}{10pt}\usefont{T1}{cmtt}{m}{n}\selectfont }

      \makeatletter
      % on fixe le langage utilisé
      \lstset{language=matlab, breaklines=true}
      \edef\Motscle{emph={\lst@keywords}}
      \expandafter\lstset\expandafter{%
       \Motscle}
      \makeatother


      \definecolor{Vvert}{rgb}{0.133,0.545,0.133}

      \lstset{emphstyle=\color{blue}, % les mots réservés de matlab en bleu
      basicstyle=\styleC,
      keywordstyle=\cmtt,
      commentstyle=\color{Vvert}\styleD, % commentaire en gris
      numberstyle=\tiny\color{red},
      numbers=left,
      numbersep=10pt,
      lineskip=0.7pt,
      showstringspaces=false}
      %  % inclure le fichier source
      \newcommand{\FSource}[1]{%
      \lstinputlisting[texcl=true]{#1}
      }

\setlength{\textwidth}{16cm} % Largeur du texte
\setlength{\textheight}{24cm} % Hauteur du texte
\setlength{\evensidemargin}{-0.2cm} % Taille des marges pour les pages paires
\setlength{\oddsidemargin}{-0.2cm} % Taille des marges pour les pages impaires
\setlength{\topmargin}{-1.5cm} % Taille de l'ent\^ete

\title{PR307 Smart-EcoBox : \\
Détection du chauffage dans le domaine temps-fréquence, approche par Spectrogramme.}
\author{Antoine Bouchain <abouchain@enseirb-matmeca.fr> \\}


\begin{document}
\maketitle

\begin{figure}[ht]
\begin{center}
\noindent \includegraphics[scale = 0.25]{../../Logo_ENSEIRB.pdf}
\end{center}
\end{figure}
\begin{figure}[ht]
\begin{center}
\noindent \includegraphics[scale = 0.25]{../../smartee_logo.pdf}
\end{center}
\end{figure}


\newpage

\tableofcontents

\newpage
\begin{abstract}
Ce rapport a pour but d'expliquer la détection d'un chauffage par analyse temps-fréquence, à l'aide d'un spectrogramme de la courbe de charge générale d'une maison. Ces travaux sont issus de la thèse de M. El Guedri intitulée "Détection, classification et estimation des usages dans les secteurs résidentiel et tertiaire." 
\end{abstract}

\section{Interprétation du Spectrogramme}
Le spectrogramme d'une courbe de charge présentant un chauffage laisse apparaitre des raies horizontales et équidistantes significatives, comme illustré figure 1 et 2. Ces raies couvrent l'ensemble du spectre, ce qui n'est pas le cas pour les autres appareils.

\begin{figure}[!h]
\begin{center}
\includegraphics[scale = 0.4]{./../../../fig/cdc_chauffage.jpg}
\caption{Courbe de Charge du chauffage}
\label{Figure}
\end{center}
\end{figure}

\begin{figure}[!h]
\begin{center}
\includegraphics[scale = 0.4]{./../../../fig/spectro_chauffage.jpg}
\caption{Spectrogramme du chauffage}
\label{Figure}
\end{center}
\end{figure}

\newpage

 
\section{Seuillage de la carte temps-fréquence}
Considérons une portion de signal présentant 3 utilisations du chauffage : à 23h20, 1h et 2h30.

\begin{figure}[!h]
\begin{center}
\includegraphics[scale = 0.4]{./../../../fig/cdc_spectro_chauffage.jpg}
\caption{Courbe de charge et spectrogramme considérés}
\label{Figure}
\end{center}
\end{figure}
 
Nous allons réaliser un seuillage du spectrogramme selon deux valeurs.
Ce seuil a été fixé arbitrairement à 40 dB. Il sera ajusté dans un second temps, une fois l'algorithme mis en place.
Chaque point $S(x,y)$ du spectrogramme de la figure 2 est seuillé de la manière suivante : \\
- Si $S(x,y) \le 40 dB$ alors $S(x,y) = -10 dB$ \\
- Sinon $S(x,y) = 1 dB$ \\

Nous obtenons alors un spectrogramme avec l'allure suivante :

\begin{figure}[!h]
\begin{center}
\includegraphics[scale = 0.4]{./../../../fig/spectro_seuil.jpg}
\caption{Spectrogramme du chauffage avec seuil à 40 dB}
\label{Figure}
\end{center}
\end{figure}

\section{Extraction des motifs fréquents}
L'idée ensuite est de réaliser une recherche de motifs rectangulaires, qui apparaissent entourés en vert sur la figure suivante.

\begin{figure}[!h]
\begin{center}
\includegraphics[scale = 0.4]{./../../../fig/spectro_seuil_2.jpg}
\caption{Spectrogramme avec motifs repérés}
\label{Figure}
\end{center}
\end{figure}

\newpage

Ces motifs seront recherchés à des fréquences spécifiques. Nous en choisissons 20 idéalement reparties entre 0.025 et 0.25.

Pour chaque fréquence $f_i, 1\le i \le 20$, on compte le nombre d'occurrence de 1 sur une fenêtre temporelle donnée (de longueur $N_f = 256$ points et de largeur 2).
Si ce nombre d'occurrence apparait sur toute toute la durée de la fenêtre, c'est que nous avons affaire à une raie qui pourrait être un chauffage.

On obtient alors une séries de rectangles qui caractérisent la présence ou non des raies spécifiques du chauffage, comme illustré sur la figure suivante :

\begin{figure}[!h]
\begin{center}
\includegraphics[scale = 0.4]{./../../../fig/spectro_motifs.jpg}
\caption{Spectrogramme avec motifs rectangulaires}
\label{Figure}
\end{center}
\end{figure}

\section{Détermination du domaine temporel}

Nous faisons alors une somme de chaque rectangle. Si la somme est strictement inférieure au nombre de fréquences d'intérêt, 20, il n'y a pas de chauffage en marche. Sinon nous supposons le chauffage en marche et affectons une valeur arbitraire de 750 W à la courbe estimée de consommation. Nous effectuons également un recadrement temporel pour correspondre à la courbe de charge initiale de la figure 3.

Voici ce que nous obtenons :

\begin{figure}[!h]
\begin{center}
\includegraphics[scale = 0.4]{./../../../fig/conso_chauffage.jpg}
\caption{Estimation de la consommation du chauffage.}
\label{Figure}
\end{center}
\end{figure}

\section{Conclusion}
La méthode présentée nécessite de nombreux calculs pour un résultat non optimal. Nous voyons clairement que la courbe d'estimation du chauffage considère une utilisation plus longue de celui-ci, par rapport à la véritable consommation.

Nous allons essayer de nous intéresser maintenant à une méthode d'avantage basée sur l'aspect temporel en s'intéressant aux différentes valeurs d'oscillation de la courbe de charge.

\end{document}


%\begin{figure}[!h]
%\begin{center}
%\includegraphics[scale = 0.4]{./fig/fig1.jpg}
%\caption{figure}
%\label{Figure}
%\end{center}
%\end{figure}
